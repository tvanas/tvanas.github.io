var net;if(!net)net={};else if("object"!=typeof net)throw Error("net already exists and is not an object");if(!net.pretopia)net.pretopia={};else if("object"!=typeof net.pretopia)throw Error("net.pretopia already exists and is not an object");if(net.pretopia.BounceIt)throw Error("net.pretopia.BounceIt already exists");
net.pretopia.BounceIt=function(na){function ba(a){for(var b=a.offsetLeft;a=a.offsetParent;)b+=a.offsetLeft;return b}function ca(a){for(var b=a.offsetTop;a=a.offsetParent;)b+=a.offsetTop;return b}function Da(){a.save();0==k%Ea&&(da=!da);0==k%oa&&(S=S==P.length-1?0:S+1);var d=Math.floor(238-k%oa/Fa);P[S]=da?306-d:d;d="#"+P[0].toString(16)+P[1].toString(16)+P[2].toString(16);a.fillStyle=d;a.fillRect(0,0,c,e);a.restore()}function Za(){document.onkeydown=function(a){switch(window.event?window.event.keyCode:
a.which){case 13:case 32:switch(r){case 0:Ga();return;case 1:Ha();return;default:return}case 38:0<r?r--:r=1;break;case 40:1>r?r++:r=0;break;default:return}B();return!1}}function $a(){window.ondevicemotion=function(a){H=I=!1;switch(window.orientation){case 0:g.ax=a.accelerationIncludingGravity.x;break;case 180:g.ax=-a.accelerationIncludingGravity.x;break;case -90:g.ax=a.accelerationIncludingGravity.y;break;case 90:g.ax=-a.accelerationIncludingGravity.y}.7<g.ax&&(H=!0);-.7>g.ax&&(I=!0)}}function Ia(){document.onkeydown=
function(a){a=window.event?window.event.keyCode:a.which;a!=Ja[T++]?T=0:T==Ja.length&&(T=0,U=!0);switch(a){case 27:t();return;case 32:0<M&&(M--,g.base=g.y,J=1);break;case 37:I=!0;break;case 39:H=!0;break;default:return}return!1};document.onkeyup=function(a){switch(window.event?window.event.keyCode:a.which){case 37:I=!1;break;case 39:H=!1;break;default:return}return!1}}function ab(){document.onkeydown=function(d){switch(window.event?window.event.keyCode:d.which){case 27:m=1;t();break;case 13:case 32:switch(m){case 0:cancelAnimationFrame(y);
y=0;E=!1;u&&(window.ondevicemotion=null);B();break;case 1:t()}m=1;return!1;case 37:case 39:return m=m?0:1,a.save(),a.strokeStyle=0==m?"#ffffff":"#000000",a.strokeRect((c>>1)-150+.5,(e>>1)+25,140,50),a.strokeStyle=1==m?"#ffffff":"#000000",a.strokeRect((c>>1)+10.5,(e>>1)+25,140,50),a.restore(),!1}}}function N(a){I=H=!1;if("touchstart"==a.type){a=a.touches[0];var b=c/3,f=ba(h),k=ca(h);a.pageX-f>=c-50&&a.pageY-k>=e-50&&!E&&t();!u&&a.pageX-f<b?I=!0:!u&&a.pageX-f>2*b?H=!0:0<M&&(M--,g.base=g.y,J=1)}}function ea(a){var b=
a.pageX-ba(h);a=a.pageY-ca(h);b>=c-40&&a>=e-40&&!E&&t()}function fa(a){var b=void 0!=a.touches?a.touches[0]:a,f=b.pageX-ba(h),b=b.pageY-ca(h),g=e/10;touchControlsInUse=void 0!=a.touches?!0:!1;f>(c>>1)-startTxtOffset&&f<(c>>1)+startTxtOffset&&b>(e>>1)-g+10&&b<(e>>1)+10?Ga():f>(c>>1)-instrTxtOffset&&f<(c>>1)+instrTxtOffset&&b>(e>>1)+20&&b<(e>>1)+1.5*g+10?Ha():f>c-200&&b>e-30?window.location="http://twitter.com/tvanas":ga&&35>f&&b>e-35&&(u=!u,B())}function Q(a){var b=void 0!=a.touches?a.touches[0]:a;
a=b.pageX-ba(h);b=b.pageY-ca(h);a>=(c>>1)-150&&a<(c>>1)-10&&b>=(e>>1)+25&&b<(e>>1)+75?(cancelAnimationFrame(y),y=0,E=!1,u&&(window.ondevicemotion=null),B()):a>=(c>>1)+10&&a<(c>>1)+150&&b>=(e>>1)+25&&b<(e>>1)+75&&t()}function ha(d,b){a.save();a.textAlign="center";b?(a.fillStyle="rgba(0, 0, 0, 0.8)",a.fillRect(0,0,c,e),a.lineWidth=3,a.strokeStyle="#ffffff",a.font="60px Futura-CondensedExtraBold, Impact, Helvetica",a.fillStyle=R,a.strokeText(d,c>>1,(e>>1)-20),a.fillText(d,c>>1,(e>>1)-20)):(a.font="18px Futura-CondensedExtraBold, Impact, Helvetica",
a.fillStyle="#f0f0f0",a.fillText(d,c>>1,(e>>1)+40));a.restore()}function t(d){if(void 0!=d&&"object"!=typeof d){if(d==E||0==y)return;E=!d}E?(Da(),h.removeEventListener("click",Q,!1),h.removeEventListener("touchstart",Q,!1),v||h.addEventListener("click",ea,!1),z&&Ia(),C&&(h.addEventListener("touchstart",N,!1),h.addEventListener("touchend",N,!1)),E=!1):(E=!0,ha("Paused",!0),h.removeEventListener("click",ea,!1),h.removeEventListener("touchstart",N,!1),h.removeEventListener("touchend",N,!1),v||h.addEventListener("click",
Q,!1),z&&ab(),C&&h.addEventListener("touchstart",Q,!1),a.save(),d=a.createLinearGradient(0,(e>>1)+25,0,(e>>1)+75),d.addColorStop(0,"#222222"),d.addColorStop(.5,"#333333"),d.addColorStop(1,"#aaaaaa"),a.fillStyle=d,a.fillRect((c>>1)-150+.5,(e>>1)+25,140,50),a.strokeStyle=z&&0==m?"#000000":"#ffffff",a.strokeRect((c>>1)-150+.5,(e>>1)+25,140,50),a.strokeStyle=z&&0==m?"#ffffff":"#000000",a.strokeRect((c>>1)-150+.5,(e>>1)+25,140,50),a.fillRect((c>>1)+10.5,(e>>1)+25,140,50),a.strokeStyle=z&&1==m?"#000000":
"#ffffff",a.strokeRect((c>>1)+10.5,(e>>1)+25,140,50),a.strokeStyle=z&&1==m?"#ffffff":"#000000",a.strokeRect((c>>1)+10.5,(e>>1)+25,140,50),a.fillStyle="#f0f0f0",a.textAlign="center",a.font="18px Futura-CondensedExtraBold, Impact, Helvetica",a.fillText("Main Menu",(c>>1)-80+.5,(e>>1)+55),a.fillText("Return to Game",(c>>1)+80.5,(e>>1)+55),a.restore())}function V(d){this.type=d;this.height=this.width=40;this.vx=0;this.x=Math.random()*(c-this.width);this.vy=4;this.y=-this.height;0>this.x&&(this.x=0);1E3<
k?this.vy+=1:1500<k?this.vy+=2:2E3<k?this.vy+=3:2500<k&&(this.vy+=4);this.invoked=!1;this.invoke=function(){if(!this.invoked)switch(this.invoked=!0,this.type){case 0:M++;break;case 1:W=k;K=2;ia=!1;break;case 2:D+=500;break;case 3:ja=!0;break;case 4:ia=!0}};this.draw=function(){if(!this.invoked)switch(this.type){case 0:a.drawImage(pa,this.x,this.y);break;case 1:a.drawImage(Ka,this.x,this.y);break;case 2:a.drawImage(La,this.x,this.y);break;case 3:a.drawImage(Ma,this.x,this.y);break;case 4:a.drawImage(Na,
this.x,this.y)}}}function qa(d,b,c){this.type=c;this.vx=2==c?3:0;this.vy=3==c?3:2;32!=ka&&(this.vy+=2);this.widthOffset=0==c?0:3;this.width=X-2*this.widthOffset;this.height=ra;this.x=d;this.y=b-this.height;this.spawnedNew=!1;this.draw=function(){var d=a.createLinearGradient(0,this.y,0,this.y+this.height);switch(this.type){case 0:d.addColorStop(0,"#f0f0f0");break;case 1:d.addColorStop(0,"#666666");break;case 2:d.addColorStop(0,"#0000bb");break;case 3:d.addColorStop(0,"#bb0000");break;default:d.addColorStop(0,
"#888888")}d.addColorStop(1,"#000000");a.beginPath();a.strokeStyle=d;a.lineWidth=this.height;a.lineCap="round";a.moveTo(this.x+this.widthOffset+this.width/40,this.y+this.height/2);a.lineTo(this.x+this.widthOffset+this.width-this.width/40,this.y+this.height/2);a.stroke()}}function Oa(){this.base=this.vy=this.y=this.x=this.ax=0;this.radius=Y;this.circumference=2*Math.PI;this.draw=function(){a.drawImage(Pa,this.x-Y,this.y-Y)}}function Qa(){y=requestAnimationFrame(Qa);sa=Date.now();ta=sa-Ra;if(!(20>ta||
(Ra=sa-ta%20,E))){0!=J&&(J>=Sa?J=0:(g.vy=g.base-Z[J]-g.y,J++));k++;W&&k-W>ua&&(W=0,K=1);g.y+=g.vy;var d=g.x,b=g.vy,F=g.radius;Da();D++;a.save();v||(a.lineWidth=3,a.strokeStyle="#ffffff",a.font="24px Futura-CondensedExtraBold, Impact, Helvetica",a.textAlign="right",a.strokeText(D,c-10,30),a.font="14px Futura-CondensedExtraBold, Impact, Helvetica",a.lineWidth=2,a.strokeText(aa,c-10,50),a.font="24px Futura-CondensedExtraBold, Impact, Helvetica");U&&(a.save(),a.lineWidth=3,a.strokeStyle="#ffffff",a.font=
"60px Futura-CondensedExtraBold, Impact, Helvetica",a.fillStyle=R,a.textAlign="center",a.strokeText("CHEATER",c>>1,e>>1),a.fillText("CHEATER",c>>1,e>>1),a.restore());for(var m=[],G=0,n=null,w=0,A=0,p=0,r=0,t=0,L=0,q=f.length,l=0;l<q;l++)if(n=f[l],w=n.x,A=n.y,p=n.vx,r=n.vy,t=n.width,L=n.height,A>e)m[G++]=l;else{if(ia)p=Math.floor(2*Math.random()),n.vx=15*(1==p?1:-1),l==q-1&&(ia=!1);else if(0!=n.type||!la||void 0!=f[l+1]&&100>A-f[l+1].y)15!=p&&-15!=p&&(0>w||w+t>c)&&(n.vx=-(n.vx+.1),n.x=0>w?0:c-t),0==
n.type&&(la=!1),n.x+=Math.round(n.vx/K),n.y+=Math.round(r/K);n.draw();0<=b&&d>=w&&d<=w+t&&g.y+F+Math.abs(Math.abs(b-r)-L)>A&&g.y+F<=A+L+F&&(g.base=g.y,J=1);spawnThreshold=3500<k?160:3E3<k?150:2500<k?140:1E3<k?130:500<k?110:90;if(!n.spawnedNew&&A>=spawnThreshold){p=Math.floor(5*Math.random());w=1;switch(p){case 0:w=2;break;case 1:w=3}ja?(ja=!1,f[f.length]=new qa(0,0,0),f[f.length-1].width=c):f[f.length]=new qa(Math.floor(Math.random()*Ta)*X,0,w);3E3<k?f[f.length-1].vy+=4:2500<k?f[f.length-1].vy+=4:
2E3<k?f[f.length-1].vy+=3:1500<k?f[f.length-1].vy+=2:1E3<k&&(f[f.length-1].vy+=1);n.spawnedNew=!0}}G=[];l=null;A=w=n=b=0;r=x.length;for(L=t=0;L<r;L++)if(l=x[L],b=l.x,n=l.y,w=l.width,A=l.height,l.y>e)G[t++]=L;else{!l.invoked&&d+F>=b&&d-F<=b+w&&g.y+F>=n&&g.y-F<=n+A&&l.invoke();l.x+=Math.round(l.vx/K);l.y+=Math.round(l.vy/K);q=f.length;for(p=0;p<q;p++)if(n+A>=f[p].y&&n+A<f[p].y+f[p].height+(f[p].vy?f[p].vy-l.vy:0)&&b+w>=f[p].x&&b<=f[p].x+f[p].width){0==f[p].type&&la?l.vy=0:(l.vx=f[p].vx,l.vy=f[p].vy,
currentPoY=f[p].y-A);break}l.draw()}for(q=0;q<G.length;q++)x.splice(G[q]-q,1);if(O<k-20)switch(Math.floor(150*Math.random())){case 0:va<k-60&&(O=va=k,x[x.length]=new V(1));break;case 1:wa<k-80&&(O=wa=k,x[x.length]=new V(2));break;case 2:xa<k-60&&(O=xa=k,x[x.length]=new V(3));break;case 3:ya<k-140&&(O=ya=k,x[x.length]=new V(4));break;case 4:case 5:za<k-20&&(O=za=k,x[x.length]=new V(0))}for(q=0;q<m.length;q++)f.splice(m[q]-q,1);I&&0<d-F?g.x-=ma-g.ax:H&&d+F<c&&(g.x+=ma+g.ax);g.draw();d=Math.floor(.66*
c/24);for(l=q=m=0;l<M;l++)m=parseInt(l/d),q=l-m*d,a.drawImage(pa,5+24*q,8+22*m,20,20);if(1<K)for(l=(ua-(k-W))/Aa,b=m+1,G=0;G<l;G++)m=parseInt(G/d)+b,q=G-(m-b)*d,a.drawImage(Ua,5+24*q,8+25*m,20,20);v&&!u&&C&&(a.drawImage(Va,16,.67*e-16),a.drawImage(Wa,c-48,.67*e-16));v&&(u||C)&&a.drawImage(Xa,(c>>1)-21,.67*e-23);v&&!u&&C&&60>k&&(a.save(),a.textAlign="center",a.fillStyle="#111111",a.font="26px Futura-CondensedExtraBold, Impact, Helvetica",a.fillText("left",32,.67*e+48),a.fillText("right",c-32,.67*e+
48),a.restore());v&&(u||C)&&60>k&&(a.save(),a.textAlign="center",a.fillStyle="#111111",a.font="26px Futura-CondensedExtraBold, Impact, Helvetica",a.fillText("star boost",c>>1,.67*e+48),a.restore());!v&&z&&80>k&&(a.save(),a.textAlign="left",a.fillStyle="#111111",a.font="20px Futura-CondensedExtraBold, Impact, Helvetica",d=a.measureText("Arrows to move ball, space bar for star boost"),a.fillText("Arrows to move ball, space bar for star boost",c-d.width>>1,e-100),a.restore());v?(a.font="22px Futura-CondensedExtraBold, Impact, Helvetica",
a.textAlign="right",a.fillStyle="#000000",a.fillText(D,c-10,30),a.fillStyle="#555555",a.font="12px Futura-CondensedExtraBold, Impact, Helvetica"):(a.fillText(D,c-10,30),a.fillStyle="#440000",a.font="14px Futura-CondensedExtraBold, Impact, Helvetica");a.fillText(aa,c-10,50);a.fillStyle="#000000";a.fillRect(c-24,e-23,4,17);a.fillRect(c-15,e-23,4,17);a.restore();g.y+F>e&&(U?g.y=0:(cancelAnimationFrame(y),y=0,h.removeEventListener("click",ea,!1),h.removeEventListener("touchstart",N,!1),ha("Game Over",
!0),!U&&parseInt(localStorage["net.pretopia.BounceIt.highScore"])<D?(ha("New highscore! "+D+" points",!1),localStorage["net.pretopia.BounceIt.highScore"]=D):ha("You scored "+D+" points",!1),v||h.addEventListener("click",B,!1),z&&(document.onkeydown=B),C&&h.addEventListener("touchstart",B,!1),u&&(window.ondevicemotion=null)))}}function Ya(){var d=null,b=null;null==(d=document.getElementById(Ba))&&(d=document.body);null!=(b=document.getElementById(Ba+"_BounceItWrapper"))&&d.removeChild(b);b=document.createElement("div");
b.id=Ba+"_BounceItWrapper";b.className="BounceItWrapper";d.appendChild(b);h=document.createElement("canvas");h.className="BounceItGameCanvas";h.width=c;h.height=e;try{a=h.getContext("2d")}catch(f){b.className+=" BounceItError";b.innerHTML='<p>HTML5 Canvas is not supported in your browser.</p><p>Use a modern browser to play BounceIt, like <a href="http://www.google.com/chrome" target="_blank">Chrome</a>, <a href="http://www.getfirefox.com" target="_blank">Firefox</a>, <a href="http://www.apple.com/safari/" target="_blank">Safari</a> or <a href="http://www.microsoft.com/downloads/en/default.aspx" target="_blank">Internet Explorer 9</a>.';
return}R=a.createLinearGradient(0,(e>>1)-50,0,(e>>1)+50);R.addColorStop(0,"#570d0e");R.addColorStop(.5,"#af1c1e");R.addColorStop(1,"#e24e50");b.appendChild(h)}function Ha(){h.removeEventListener("click",fa,!1);h.removeEventListener("touchstart",fa,!1);v||h.addEventListener("click",B,!1);z&&(document.onkeydown=B);C&&h.addEventListener("touchstart",B,!1);a.save();var d=a.createRadialGradient(c>>2,e>>2,10,c>>1,c>>1,c);d.addColorStop(0,"#444444");d.addColorStop(.5,"#200000");d.addColorStop(1,"#000000");
a.fillStyle="Android"==myBrowser.OS.name?"#000000":d;a.fillRect(0,0,c,e);d=e/30;instructionsText="The objective in BounceIt is to get as;many points possible, by bouncing up.;;Different types of powerups fall down;that will help you during your journey.;;You can control the ball using your;keyboard, touch screen or accelero-;meter. Press the space bar to use a star;and bounce-boost the ball. On a touch;screen, tap the transparent star in the;center of the screen;;Click, touch or press any key to return;to the menu".split(";");
a.textAlign="left";a.fillStyle="#bbbbbb";a.font=d+"px Futura-CondensedExtraBold, Impact, Helvetica";for(var b=a.measureText(instructionsText[8]),b=c-b.width>>1,f=0;f<instructionsText.length;f++)a.fillText(instructionsText[f],b,d*f+3*d);a.restore()}function B(){var d=e/11;aa=0<localStorage["net.pretopia.BounceIt.highScore"]?localStorage["net.pretopia.BounceIt.highScore"]:0;Ya();h.removeEventListener("click",Q,!1);h.removeEventListener("touchstart",Q,!1);a.save();var b=a.createRadialGradient(c>>2,e>>
2,10,c>>1,c>>1,c);b.addColorStop(0,"#444444");b.addColorStop(.5,"#200000");b.addColorStop(1,"#000000");a.fillStyle="Android"==myBrowser.OS.name?"#000000":b;a.fillRect(0,0,c,e);b=a.createLinearGradient(0,40,0,100);b.addColorStop(0,"#570d0e");b.addColorStop(.5,"#af1c1e");b.addColorStop(1,"#e24e50");a.textAlign="center";a.fillStyle=b;a.strokeStyle="#ffffff";a.lineWidth=2;a.font=1.7*d+"px Futura-CondensedExtraBold, Impact, Helvetica";a.fillText("BounceIt",c>>1,2.5*d+10);a.strokeText("BounceIt",c>>1,2.5*
d+10);a.fillStyle="#ffffff";a.font=d/2+"px Futura-CondensedExtraBold, Impact, Helvetica";a.fillText("Highscore: "+aa,c>>1,4*d);a.fillStyle="#000000";a.lineWidth=1.5;a.font=d+"px Futura-CondensedExtraBold, Impact, Helvetica";a.fillText("Start Game",c>>1,e>>1);a.strokeText("Start Game",c>>1,e>>1);a.fillText("Instructions",c>>1,(e>>1)+1.5*d);a.strokeText("Instructions",c>>1,(e>>1)+1.5*d);var b=a.measureText("Start Game"),f=a.measureText("Instructions");startTxtOffset=(b.width>>1)+25;instrTxtOffset=(f.width>>
1)+25;ga&&(a.fillStyle=u?"#ff0000":"#000000",a.fillRect(10,e-25,15,15),a.strokeRect(10,e-25,15,15),a.font=d/3+"px Futura-CondensedExtraBold, Impact, Helvetica",a.fillStyle="#f0f0f0",a.textAlign="left",a.fillText("Accelerometer",35,e-11));a.fillStyle="#cccccc";a.font="13px Helvetica";a.textAlign="right";a.fillText("v1.0 - By Thijs van As, 2011",c-7,e-10);a.restore();v||h.addEventListener("click",fa,!1);z&&(b=new Oa,b.x=(c>>1)-instrTxtOffset-10,b.y=(e>>1)+d*(2==r?3.5:1.5*r)-d/3,b.draw(),Za());C&&h.addEventListener("touchstart",
fa,!1)}function Ga(){Ta=c/X;0!=y&&(cancelAnimationFrame(y),y=0);I=H=!1;Ya();f=[];f[0]=new qa(0,e>>1,0);f[0].width=c;x=[];g=new Oa;g.y=(e>>1)-g.radius;g.x=c>>1;g.base=g.y;k=D=0;M=3;U=!1;T=0;P=[238,238,238];S=0;oa=500;Ea=1500;Fa=2.9;ja=da=!1;slowMotionstart=0;K=1;la=!0;za=ya=xa=wa=va=O=0;if(void 0===localStorage["net.pretopia.BounceIt.highScore"]||null===localStorage["net.pretopia.BounceIt.highScore"])localStorage["net.pretopia.BounceIt.highScore"]=0;aa=localStorage["net.pretopia.BounceIt.highScore"];
Z=[];for(var a=Math.PI/ka,b=Ca,m=0;m<Math.PI;m+=a)Z[Z.length]=Math.round(Math.sin(m)*b);Sa=Z.length;z&&Ia();u&&$a();C&&(h.addEventListener("touchstart",N,!1),h.addEventListener("touchend",N,!1));v||h.addEventListener("click",ea,!1);y=requestAnimationFrame(Qa)}var Ba=null!=na&&""!=na?na:"BounceItInstance",h=null,a=null,y=0,Aa=30,v=!1,ua=80,Xa=new Image;Xa.src="img/transparent_star.png";var Va=new Image;Va.src="img/left.png";var Wa=new Image;Wa.src="img/right.png";var Ka=new Image;Ka.src="img/hourglass.png";
var Ua=new Image;Ua.src="img/hourglass-mini.png";var pa=new Image;pa.src="img/star.png";var Pa=new Image;Pa.src="img/ball.png";var La=new Image;La.src="img/500.png";var Ma=new Image;Ma.src="img/base.png";var Na=new Image;Na.src="img/bomb.png";var J=0,ka=40,ma=7,e=420,c=320,X=80,ra=10,Ta=0,Y=9,Ca=150,I=!1,H=!1,f=null,x=null,g=null,aa=0,D=0,k=0,M=0,W=0,K=1,ja=!1,ia=!1,la=!0,O=0,za=0,va=0,wa=0,xa=0,ya=0,Z=[],Sa=0,ga=!1,z=!0,C=!0,u=!1,r=0,m=1,R=null,E=!1,U=!1,Ja=[38,38,40,40,37,39,37,39,66,65],T=0,P=
[238,238,238],S=0,oa=500,Ea=1500,Fa=2.9,da=!1,sa,ta,Ra=Date.now();this.main=function(a){"object"==typeof a&&(z=void 0!=a.attachKeyboard?a.attachKeyboard:!0,C=void 0!=a.attachTouchControls?a.attachTouchControls:!0,ga=void 0!=a.accelerometerEnabled?a.accelerometerEnabled:!1,c=void 0!=a.gameAreaWidth?a.gameAreaWidth:c,e=void 0!=a.gameAreaHeight?a.gameAreaHeight:e,X=void 0!=a.platformWidth?a.platformWidth:X,ra=void 0!=a.platformHeight?a.platformHeight:ra,Y=void 0!=a.ballRadius?a.ballRadius:Y,ma=void 0!=
a.lrSpeed?a.lrSpeed:ma,Ca=void 0!=a.ballAmplitude?a.ballAmplitude:Ca,Aa=void 0!=a.coreLoopInterval?a.coreLoopInterval:Aa,ka=void 0!=a.stepDivider?a.stepDivider:ka,ua=100,u=ga);v=myBrowser.isMobile;B()};this.pause=t};