var net;if(!net)net={};else if("object"!=typeof net)throw Error("net already exists and is not an object");if(!net.pretopia)net.pretopia={};else if("object"!=typeof net.pretopia)throw Error("net.pretopia already exists and is not an object");if(net.pretopia.SweepIt)throw Error("net.pretopia.SweepIt already exists");
net.pretopia.SweepIt=function(v){function A(c){for(var b=c.offsetTop;c=c.offsetParent;)b+=c.offsetTop;return b}function I(){if(999<=l){clearInterval(m);m=0;r=!1;w(!1);var c=document.getElementById("endGamePanel");c.className="slider";c.style.fontSize="60px";c.innerHTML='<div style="margin-top: 35px;">Game Over</div>';var b=document.createElement("div");b.className="retryButton";b.innerHTML="Play again";b.addEventListener("click",function(){loadGame()},!1);b.addEventListener("touchstart",function(){loadGame()},
!1);c.appendChild(b)}else l++,c=Math.floor(l/60),b=l-60*c,document.getElementById(g+"_numSecs").innerHTML=c+":"+(10>b?"0":"")+b}function u(c,b,a){b=c.split("_");c=parseInt(b[0]);b=parseInt(b[1]);if(r&&"open"!=f[b][c].state)if(0==m&&(m=setInterval(function(){I()},1E3),document.getElementById(g+"_numSecs").innerHTML="0:00"),a)B(c,b);else switch(C){case !0:if("flagged"==f[b][c].state)break;D(c,b);break;case !1:B(c,b)}}function E(c,b){var a=Array(8),d=0,e=null;0<c&&(a[d]={x:c-1,y:b},d++,0<b&&(a[d]={x:c-
1,y:b-1},d++),b<k-1&&(a[d]={x:c-1,y:b+1},d++));c<h-1&&(a[d]={x:c+1,y:b},d++,0<b&&(a[d]={x:c+1,y:b-1},d++),b<k-1&&(a[d]={x:c+1,y:b+1},d++));0<b&&(a[d]={x:c,y:b-1},d++);b<k-1&&(a[d]={x:c,y:b+1},d++);for(var e=Array(d),f=0;f<d;f++)e[f]=a[f];return e}function w(c){for(var b=null,a=0;a<k;a++)for(var d=0;d<h;d++)switch(b=document.getElementById(g+"_col_"+d+"_"+a),b.innerHTML=0<f[a][d].value?f[a][d].value:"",b.style.backgroundImage="",b.style.backgroundColor="",-1==f[a][d].value&&(b.style.backgroundImage=
"url('img/bomb.png')",b.style.backgroundRepeat="no-repeat",b.style.backgroundSize="50%",b.style.backgroundPosition="center center"),b.className=c?"SweepItSquarePosition SweepItSquareSize SweepItSquareOpen":"SweepItSquarePosition SweepItSquareSize SweepItSquareLoose",f[a][d].value){case -1:b.style.color="#bb0000";break;case 0:b.style.color="#9999";break;case 1:b.style.color="#142afa";break;case 2:b.style.color="#307108";break;case 3:b.style.color="#e62e25";break;case 4:b.style.color="#08126d";break;
case 5:b.style.color="#6b1611";break;case 6:b.style.color="#2b6f6d";break;case 7:b.style.color="#000000";break;case 8:b.style.color="#6d6d6d";break;default:b.style.color="#0000ff"}}function B(c,b){var a=document.getElementById(g+"_col_"+c+"_"+b);switch(f[b][c].state){case "closed":f[b][c].state="flagged";a.style.color="#008800";a.style.backgroundColor="#ffffff";a.style.backgroundImage="url('img/flag.png')";a.style.backgroundRepeat="no-repeat";a.style.backgroundSize="50%";a.style.backgroundPosition=
"center center";break;case "flagged":a.style.backgroundImage="",a.style.backgroundColor="",f[b][c].state="closed",a.innerHTML=""}}function D(c,b){var a=null,d=document.getElementById(g+"_timer"),a=document.getElementById(g+"_col_"+c+"_"+b);a.innerHTML=0<f[b][c].value?f[b][c].value:"";a.style.backgroundImage="";a.style.backgroundColor="";-1==f[b][c].value&&(a.style.backgroundImage="url('img/bomb.png')",a.style.backgroundRepeat="no-repeat",a.style.backgroundSize="50%",a.style.backgroundPosition="center center");
a.className="SweepItSquarePosition SweepItSquareSize SweepItSquareOpen";f[b][c].state="open";x--;switch(f[b][c].value){case -1:a.style.color="#ff0000";break;case 0:a.style.color="#9999";break;case 1:a.style.color="#142afa";break;case 2:a.style.color="#307108";break;case 3:a.style.color="#e62e25";break;case 4:a.style.color="#08126d";break;case 5:a.style.color="#6b1611";break;case 6:a.style.color="#2b6f6d";break;case 7:a.style.color="#000000";break;case 8:a.style.color="#6d6d6d";break;default:a.style.color=
"#0000ff"}if(-1==f[b][c].value)clearInterval(m),m=0,r=!1,w(!1),a=document.getElementById("endGamePanel"),a.className="slider",a.style.fontSize="60px",a.innerHTML='<div style="margin-top: 35px;">Game Over</div>',d=document.createElement("div"),d.className="retryButton",d.innerHTML="Play again",d.addEventListener("click",function(){loadGame()},!1),d.addEventListener("touchstart",function(){loadGame()},!1),a.appendChild(d);else{if(0==f[b][c].value)for(var a=E(c,b),e=0;e<a.length;e++)"open"!=f[a[e].y][a[e].x].state&&
D(a[e].x,a[e].y);r&&x==y&&(clearInterval(m),m=0,r=!1,w(!0),d.innerHTML="",d=Math.floor(l/60),a=l-60*d,d=d+":"+(10>a?"0":"")+a,l<n?(localStorage["net.pretopia.SweepIt.highScore"]=l,a=document.getElementById("endGamePanel"),a.className="slider",a.style.fontSize="60px",a.innerHTML='<div style="margin-top: 35px; color: #7dff52;">Woohoo!</div>',a.innerHTML+='<div style="margin-top: 15px; font-size: 20px;">You cleard the minefield in <span style="color: #7dff52;">'+d+"</span>, a new personal best!</div>"):
(a=Math.floor(n/60),e=n-60*a,e=a+":"+(10>e?"0":"")+e,a=document.getElementById("endGamePanel"),a.className="slider",a.style.fontSize="60px",a.innerHTML='<div style="margin-top: 35px; color: #7dff52;">Hooray!</div>',a.innerHTML+='<div style="margin-top: 15px; font-size: 20px;">You cleared the minefield in <span style="color: #7dff52;">'+d+"</span>!</div>",a.innerHTML+='<div style="margin-top: 15px; font-size: 20px;">Try beating your personal best of '+e+"</div>"),d=document.createElement("div"),d.className=
"retryButton",d.innerHTML="Play again",d.addEventListener("click",function(){loadGame()},!1),d.addEventListener("touchstart",function(){loadGame()},!1),a.appendChild(d))}}function J(){var c=null,b=null,a=c=null,d=Math.floor(q/h)-2;document.getElementById("endGamePanel").className="slider closed";n=999>localStorage["net.pretopia.SweepIt.highScore"]?localStorage["net.pretopia.SweepIt.highScore"]:999;null==(b=document.getElementById(g))&&(b=document.body);null!=(c=document.getElementById(g+"_SweepItWrapper"))&&
b.removeChild(c);c=document.createElement("div");c.id=g+"_SweepItWrapper";c.className="SweepItWrapper";b.appendChild(c);timerDiv=document.createElement("div");timerDiv.id=g+"_timer";timerDiv.className="SweepItTimer";timerDiv.style.fontSize="34px";timerDiv.style.position="relative";timerDiv.style.width=q+"px";timerDiv.style.color="#37474f";timerDiv.innerHTML="";numSecsDiv=document.createElement("div");numSecsDiv.id=g+"_numSecs";numSecsDiv.style.textlign="center";numSecsDiv.innerHTML=0<l?l:"Tap a square to start";
timerDiv.appendChild(numSecsDiv);highScoreDiv=document.createElement("div");highScoreDiv.id=g+"_highScore";highScoreDiv.style.textlign="center";if(999>n){var a=Math.floor(n/60),e=n-60*a;highScoreDiv.innerHTML='<div style="font-size: 14px; color: #4f6672;">Personal best: '+a+":"+(10>e?"0":"")+e+"</div>"}timerDiv.appendChild(highScoreDiv);a=document.createElement("div");a.id=g+"_field";a.className="SweepItBoard";a.style.width=(d+4)*h+"px";c.appendChild(a);c.appendChild(timerDiv);for(e=0;e<k;e++)for(var t=
0;t<h;t++)c=document.createElement("div"),c.id=g+"_col_"+t+"_"+e,c.className="SweepItSquarePosition SweepItSquareClosed",c.value=t+"_"+e,c.style.width=d+"px",c.style.height=d+"px",c.style.fontSize=.6*d+"px",c.style.lineHeight=1*d+"px",c.oncontextmenu=function(){return!1},F?(c.addEventListener("touchstart",function(){G=this.value;H=window.setTimeout(function(){u(G,event,!0);z=!0},200)},!1),c.addEventListener("touchend",function(){clearTimeout(H);touchEndCOurd=this.value;z||u(this.value,event,!1);z=
!1},!1)):(c.addEventListener("click",function(){u(this.value,event,!1)},!1),c.addEventListener("contextmenu",function(){u(this.value,event,!0)},!1),c.addEventListener("mouseover",function(){var a=this.value.split("_"),b=parseInt(a[0]),a=parseInt(a[1]);"closed"==f[a][b].state&&(this.style.backgroundColor="#ffffff")},!1),c.addEventListener("mouseout",function(){var a=this.value.split("_"),b=parseInt(a[0]),a=parseInt(a[1]);"closed"==f[a][b].state&&(this.style.backgroundColor="#e0e0e0")},!1)),a.appendChild(c),
t==h-1&&(c=document.createElement("div"),c.style.width="0px",c.style.height=d+"px",a.appendChild(c));a=document.getElementById("copyright");a.style.width=q+"px";a.style.marginLeft=-(q/2)+"px";b=A(a)-(A(b)+(d+4)*k);200<b&&(document.body.style.paddingTop="60px",b-=60);timerDiv.style.top=b/2-36+"px"}var g=null!=v&&""!=v?v:"SweepItInstance",k=8,h=8,y=10,q=600,x=k*h,f=null,r=!0,C=!0,l=0,m=0,G="",H=null,F=!1,z=!1,n=999;this.main=function(c,b,a,d){k=null!=b&&0<b&&25>b?b:8;h=null!=a&&0<a&&33>a?a:8;y=null!=
d&&0<d&&d<b*a?d:Math.ceil(k*h/7);F=myBrowser.isMobile;c=parseInt(c);q=540>c?c:540;q-=25;C=r=!0;x=k*h;l=0;0!=m&&(clearInterval(m),m=0);f=Array(k);c=0;d=null;b=y;a=k*h;d=Array(b);for(var e=-1,g=!0,p=0;p<b;p++){for(;g;)for(var e=Math.floor(Math.random()*a),n=0;n<=p;n++)if(d[n]==e){g=!0;break}else g=!1;d[p]=e;g=!0}mineIndexes=d;for(b=0;b<k;b++)for(f[b]=Array(h),a=0;a<h;a++){d=f[b];e=a;g=!1;for(p=0;p<mineIndexes.length;p++)if(mineIndexes[p]==b*h+a){g=!0;break}d[e]={value:g?-1:0,state:"closed"}}for(b=0;b<
k;b++)for(a=0;a<h;a++)if(-1!=f[b][a].value){d=E(a,b);for(e=0;e<d.length;e++)-1==f[d[e].y][d[e].x].value&&c++;f[b][a].value=c;c=0}J()}};